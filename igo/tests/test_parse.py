# coding: utf-8
from __future__ import unicode_literals

import igo.tagger


def flat(m):
    return m.surface, m.feature, m.start


# t = igo.tagger.Tagger('ipadic_gae', gae=True)
def test_simple():
    t = igo.tagger.Tagger()
    a = [flat(x) for x in t.parse('ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ')]
    e = [('ã“ã‚“ã«ã¡ã¯', 'æ„Ÿå‹•è©,*,*,*,*,*,ã“ã‚“ã«ã¡ã¯,ã‚³ãƒ³ãƒ‹ãƒãƒ,ã‚³ãƒ³ãƒ‹ãƒãƒ¯', 0),
         ('ä¸–ç•Œ', 'åè©,ä¸€èˆ¬,*,*,*,*,ä¸–ç•Œ,ã‚»ã‚«ã‚¤,ã‚»ã‚«ã‚¤', 5)]
    assert a == e

    a = [flat(x) for x in t.parse('ç§ã®åå‰ã¯ä¸­é‡ã§ã™ã€‚')]
    e = [('ç§', 'åè©,ä»£åè©,ä¸€èˆ¬,*,*,*,ç§,ãƒ¯ã‚¿ã‚·,ãƒ¯ã‚¿ã‚·', 0),
         ('ã®', 'åŠ©è©,é€£ä½“åŒ–,*,*,*,*,ã®,ãƒ,ãƒ', 1),
         ('åå‰', 'åè©,ä¸€èˆ¬,*,*,*,*,åå‰,ãƒŠãƒã‚¨,ãƒŠãƒã‚¨', 2),
         ('ã¯', 'åŠ©è©,ä¿‚åŠ©è©,*,*,*,*,ã¯,ãƒ,ãƒ¯', 4),
         ('ä¸­é‡', 'åè©,å›ºæœ‰åè©,åœ°åŸŸ,ä¸€èˆ¬,*,*,ä¸­é‡,ãƒŠã‚«ãƒ,ãƒŠã‚«ãƒ', 5),
         ('ã§ã™', 'åŠ©å‹•è©,*,*,*,ç‰¹æ®Šãƒ»ãƒ‡ã‚¹,åŸºæœ¬å½¢,ã§ã™,ãƒ‡ã‚¹,ãƒ‡ã‚¹', 7),
         ('ã€‚', 'è¨˜å·,å¥ç‚¹,*,*,*,*,ã€‚,ã€‚,ã€‚', 9)]
    assert a == e


def test_surrogate_pairs():
    t = igo.tagger.Tagger()
    a = [flat(x) for x in t.parse('ãŠã¯ã‚ˆã†ãƒ¼ğŸ˜³ã“ã‚“ã«ã¡ã¯ãƒ¼ç¾å‘³ã—ã„ã”é£¯ã ã‚ˆ')]
    e = [('ãŠã¯ã‚ˆã†', 'æ„Ÿå‹•è©,*,*,*,*,*,ãŠã¯ã‚ˆã†,ã‚ªãƒãƒ¨ã‚¦,ã‚ªãƒãƒ¨ãƒ¼', 0),
         ('ãƒ¼', 'åè©,ä¸€èˆ¬,*,*,*,*,*', 4), ('ğŸ˜³', 'è¨˜å·,ä¸€èˆ¬,*,*,*,*,*', 5),
         ('ã“ã‚“ã«ã¡ã¯', 'æ„Ÿå‹•è©,*,*,*,*,*,ã“ã‚“ã«ã¡ã¯,ã‚³ãƒ³ãƒ‹ãƒãƒ,ã‚³ãƒ³ãƒ‹ãƒãƒ¯', 7),
         ('ãƒ¼', 'åè©,ä¸€èˆ¬,*,*,*,*,*', 12),
         ('ç¾å‘³ã—ã„', 'å½¢å®¹è©,è‡ªç«‹,*,*,å½¢å®¹è©ãƒ»ã‚¤æ®µ,åŸºæœ¬å½¢,ç¾å‘³ã—ã„,ã‚ªã‚¤ã‚·ã‚¤,ã‚ªã‚¤ã‚·ã‚¤', 13),
         ('ã”é£¯', 'åè©,ä¸€èˆ¬,*,*,*,*,ã”é£¯,ã‚´ãƒãƒ³,ã‚´ãƒãƒ³', 17),
         ('ã ', 'åŠ©å‹•è©,*,*,*,ç‰¹æ®Šãƒ»ãƒ€,åŸºæœ¬å½¢,ã ,ãƒ€,ãƒ€', 19),
         ('ã‚ˆ', 'åŠ©è©,çµ‚åŠ©è©,*,*,*,*,ã‚ˆ,ãƒ¨,ãƒ¨', 20)]
    assert a == e

    a = [flat(x) for x in t.parse('ğŸ˜³')]
    e = [('ğŸ˜³', 'è¨˜å·,ä¸€èˆ¬,*,*,*,*,*', 0)]
    assert a == e

    a = [flat(x) for x in t.parse('ğŸ˜³ğŸ˜³')]
    e = [('ğŸ˜³ğŸ˜³', 'è¨˜å·,ä¸€èˆ¬,*,*,*,*,*', 0)]
    assert a == e

    a = [flat(x) for x in t.parse('ğŸ˜³ãŠã¯ã‚ˆã†')]
    e = [('ğŸ˜³', 'è¨˜å·,ä¸€èˆ¬,*,*,*,*,*', 0),
         ('ãŠã¯ã‚ˆã†', 'æ„Ÿå‹•è©,*,*,*,*,*,ãŠã¯ã‚ˆã†,ã‚ªãƒãƒ¨ã‚¦,ã‚ªãƒãƒ¨ãƒ¼', 2)]
    assert a == e

    a = [flat(x) for x in t.parse('ãŠã¯ã‚ˆã†ğŸ˜³')]
    e = [('ãŠã¯ã‚ˆã†', 'æ„Ÿå‹•è©,*,*,*,*,*,ãŠã¯ã‚ˆã†,ã‚ªãƒãƒ¨ã‚¦,ã‚ªãƒãƒ¨ãƒ¼', 0),
         ('ğŸ˜³', 'è¨˜å·,ä¸€èˆ¬,*,*,*,*,*', 4)]
    assert a == e
